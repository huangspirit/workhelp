(my["webpackJsonp"]=my["webpackJsonp"]||[]).push([["pages/index/index"],{"056e":function(t,e,n){"use strict";n.r(e);var o=n("e0b5"),r=n("6d28");for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("de29");var i,s=n("f0c5"),u=Object(s["a"])(r["default"],o["b"],o["c"],!1,null,"1502c611",null,!1,o["a"],i);e["default"]=u.exports},"6d28":function(t,e,n){"use strict";n.r(e);var o=n("ce16"),r=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=r.a},a96a:function(t,e,n){"use strict";(function(t){n("fd83");o(n("66fd"));var e=o(n("056e"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("c11b")["createPage"])},ac0b:function(t,e,n){},ce16:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n("a34a"));function r(t){return t&&t.__esModule?t:{default:t}}function a(t,e,n,o,r,a,i){try{var s=t[a](i),u=s.value}catch(c){return void n(c)}s.done?e(u):Promise.resolve(u).then(o,r)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var i=t.apply(e,n);function s(t){a(i,o,r,s,u,"next",t)}function u(t){a(i,o,r,s,u,"throw",t)}s(void 0)}))}}function s(t){return l(t)||c(t)||f(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function l(t){if(Array.isArray(t))return h(t)}function d(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=f(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,a=t},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function f(t,e){if(t){if("string"===typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var p=function(){n.e("components/uni-number-box/uni-number-box").then(function(){return resolve(n("2886"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("mycomponents/addbusketdetail").then(function(){return resolve(n("3713"))}.bind(null,n)).catch(n.oe)},m=function(){Promise.all([n.e("common/vendor"),n.e("components/uni-popup/uni-popup")]).then(function(){return resolve(n("c042"))}.bind(null,n)).catch(n.oe)},v=function(){n.e("components/uni-search-bar/uni-search-bar").then(function(){return resolve(n("f616"))}.bind(null,n)).catch(n.oe)},b=function(){n.e("components/uni-load-more/uni-load-more").then(function(){return resolve(n("f0f0"))}.bind(null,n)).catch(n.oe)},y=(getApp({allowDefault:!0}),{components:{uniLoadMore:b,uniNumberBox:p,uniSearchBar:v,uniPopup:m,addbusketDetail:g},onLoad:function(e){console.log(e),console.log("uni",t)},data:function(){return{scrollTop:0,old:{scrollTop:0},pageNumber:1,pageSize:10,searchKey:"",reload:!0,sortFlag:!0,status:"more",contentText:{contentdown:"上拉加载更多~",contentrefresh:"加载中",contentnomore:"我是有底线的~"},sortParam:{name:"createTime",order:"desc"},totalCount:0,data1:[],data2:[],data3:[],storeId:"1343926392932405249",selectGoods:[],popName:"",addBusketItem:{},show:!1,defaultArea:{name:"点击选择职场"},indexVal:[0,0,0],searchCont:"",choseCate:{categroryName:"全部用品",categoryId:"-1"},noticeList:[],catelist:[],goodslist:[]}},mounted:function(){console.log(this.$service),this.getnoticelist(),this.loadProvinces()},watch:{choseCate:{handler:function(t){this.pageNumber=1,this.getGoodsList()},deep:!0},defaultArea:{handler:function(t){console.log("11111",t),this.getGoodsCategory()},deep:!0},indexVal:{handler:function(t,e){return t[0]!=e[0]?(this.indexVal[1]=0,this.indexVal[2]=0,void this.loadCities(this.data1[t[0]].id)):t[1]!=e[1]?(this.indexVal[2]=0,void this.loadAreas(this.data2[t[1]].id)):void 0},deep:!0}},methods:{clearCart:function(){localStorage.removeItem("busket"),this.selectGoods=[]},checkLogin:function(){var t=localStorage.getItem("accessToken");null==t&&this.openpop("login",null,!0)},upper:function(t){},lower:function(t){this.pageNumber<this.totalCount&&(this.pageNumber++,this.getGoodsList())},scroll:function(t){this.old.scrollTop=t.detail.scrollTop},sortPrice:function(){this.sortFlag?(this.sortFlag=!1,this.sortParam={name:"price",order:"desc"}):(this.sortFlag=!0,this.sortParam={name:"price",order:"asc"}),this.getGoodsList()},sortAmount:function(){this.sortFlag?(this.sortFlag=!1,this.sortParam={name:"amount",order:"desc"}):(this.sortFlag=!0,this.sortParam={name:"amount",order:"asc"}),this.pageNumber=1,this.getGoodsList()},getnoticelist:function(){var t=this;this.http({url:"/api/app/v1/goods/getFeedBack",data:{pageSize:20,pageNumber:1},success:function(e){t.noticeList=e.result.content}})},binddata:function(t){console.log(t.detail),this.searchKey=t.detail.value,this.pageNumber=1,this.getGoodsList()},bindChange1:function(t){this.indexVal=[t.target.value[0]||0,t.target.value[1]||0,t.target.value[2]||0]},getGoodsCategory:function(){var t=this;this.http({url:"/api/app/v1/goods/getGoodsCategory",data:{address:this.defaultArea.name},method:"get",success:function(e){if(e.success){if(t.catelist=[],e.result.length>0){t.catelist.push({categroryName:"全部用品",categoryId:"-1"});var n,o=d(e.result);try{for(o.s();!(n=o.n()).done;){var r=n.value;t.catelist.push({categroryName:r.categroryName,categoryId:r.categoryId})}}catch(a){o.e(a)}finally{o.f()}}else t.catelist=[];t.pageNumber=1,t.getGoodsList()}},fail:function(t){console.log(t)}})},getGoodsList:function(){var e=this;this.http({url:"/api/app/v1/goods/getGoodsList",data:{cateId:"-1"==this.choseCate.categoryId?"":this.choseCate.categoryId,storeId:this.storeId,goodsName:this.searchKey,pageSize:this.pageSize,isSale:1,pageNumber:this.pageNumber,sort:this.sortParam.name,order:this.sortParam.order},method:"get",success:function(n){n.success?(e.totalCount=n.result.totalPages,n.result.content?1==e.pageNumber?e.goodslist=n.result.content:e.goodslist=[].concat(s(e.goodslist),s(n.result.content)):1==e.pageNumber&&(e.goodslist=[]),n.result.last&&(e.reload=!1),console.log(e.goodslist)):t.showToast({icon:"none",title:n.message})},fail:function(e){t.showToast({icon:"none",title:"服务器异常"})}})},onReachBottom:function(){this.totalCount>this.pageNumber?(this.status="loading",this.pageNumber++,this.getGoodsList()):this.status="noMore"},loadProvinces:function(){var t=this;this.http({url:"/api/app/v1/goods/getFirstRegion",method:"get",success:function(e){t.data1=e.result,t.loadCities(t.data1[0].id)},fail:function(){var t=i(o.default.mark((function t(e){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()})},loadCities:function(t){var e=this,n=this;this.http({url:"/api/app/v1/goods/getSecondRegion",data:{pageSize:20,pageNumber:1,parentId:t},method:"get",success:function(t){n.data2=t.result,n.data2.length?e.loadAreas(t.result[0].id):e.data2=[]},fail:function(){var t=i(o.default.mark((function t(e){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()})},loadAreas:function(t){var e=this;this.http({url:"/api/app/v1/goods/getWareHouse",data:{regionId:t},method:"get",success:function(){var t=i(o.default.mark((function t(n){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.data3=n.result;case 1:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),fail:function(){var t=i(o.default.mark((function t(e){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()})},buyHandler:function(){var e=0;0==e?this.openpop("buyRes",null,!0):1==e?t.showToast({icon:"none",title:"超出部门限额"}):2==e?t.showToast({icon:"none",title:"正常余额不足"}):3==e&&t.showToast({icon:"none",title:"库存不足"})},openpop:function(e,n,o){this.popName=e,"addbusket"==e?this.addBusketItem=n:"workArea"==e?this.indexVal=[0,0,0]:"cart"==e&&(this.selectGoods=JSON.parse(localStorage.getItem("busket"))||[]),this.$refs[e].open(),o||setTimeout((function(){t.hideTabBar({})}),50)},closePop:function(){this.$refs[this.popName].close()},ensureArea:function(){console.log("确认选择"),console.log(this.data3),console.log(this.indexVal),this.defaultArea={name:this.data3[this.indexVal[2]].name},this.storeId=this.data3[this.indexVal[2]].id,this.$refs[this.popName].close()},sureLogin:function(){console.log("确认登录");var t=this;dd.ready((function(){dd.runtime.permission.requestAuthCode({corpId:"dingf18bee9ed6460022",onSuccess:function(e){var n=e.code;console.log(n),t.getLogin(n)},onFail:function(t){console.log("登录异常，请稍后重试!",JSON.stringify(t))}})})),this.$refs[this.popName].close()},getLogin:function(e){var n=this;this.http({url:"/api/social/dingding/getUserInfoByCode",data:{authCode:e},method:"get",success:function(){var e=i(o.default.mark((function e(r){var a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r.success?(a=r.result,localStorage.setItem("accessToken",a),n.getUserInfo(),t.showLoading({title:"数据加载中"}),setTimeout((function(){t.hideLoading()}),1e3)):t.showToast({icon:"none",title:r.message});case 1:case"end":return e.stop()}}),e)})));function r(t){return e.apply(this,arguments)}return r}(),fail:function(){var t=i(o.default.mark((function t(e){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()})},getUserInfo:function(){this.http({url:"/api/app/v1/member/info",data:{},header:{},method:"get",success:function(){var e=i(o.default.mark((function e(n){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.success?localStorage.setItem("userInfo",JSON.stringify(n.result)):t.showToast({icon:"none",title:n.message});case 1:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}(),fail:function(){var t=i(o.default.mark((function t(e){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()})},changepop:function(e){console.log(e),e.show||t.showTabBar({})},getDetail:function(e){t.navigateTo({url:"/pages/index/detail?goodsId="+e.id})}}});e.default=y}).call(this,n("c11b")["default"])},de29:function(t,e,n){"use strict";var o=n("ac0b"),r=n.n(o);r.a},e0b5:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return o}));var o={uniPopup:function(){return Promise.all([n.e("common/vendor"),n.e("components/uni-popup/uni-popup")]).then(n.bind(null,"c042"))},uniNumberBox:function(){return n.e("components/uni-number-box/uni-number-box").then(n.bind(null,"2886"))}},r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.__map(t.goodslist,(function(e,n){var o=t.__get_orig(e),r=e.url.split(",");return{$orig:o,g0:r}}))),o=t.addBusketItem.url?t.addBusketItem.url.split(","):null;t._isMounted||(t.e0=function(e,n){var o=arguments[arguments.length-1].currentTarget.dataset,r=o.eventParams||o["event-params"];n=r.item;t.choseCate=n}),t.$mp.data=Object.assign({},{$root:{l0:n,g1:o}})},a=[]}},[["a96a","common/runtime","common/vendor"]]]);